<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="1.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="11313"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="Commodity" custom_title="0" dock_id="2" table="4,9:mainCommodity"/><dock_state state="000000ff00000000fd00000001000000020000034200000257fc0100000002fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500320100000000000003420000012e00ffffff000002790000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Commodity" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="159"/><column index="2" value="39"/><column index="3" value="77"/><column index="4" value="300"/><column index="5" value="79"/><column index="6" value="79"/><column index="7" value="79"/><column index="8" value="159"/><column index="9" value="71"/><column index="10" value="127"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Процент и стоимость" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="300"/><column index="2" value="211"/><column index="3" value="84"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 2">CREATE VIEW MetroS AS
SELECT country AS Country, lines, stations, annual_ridership_mill, inauguration AS Year
FROM Metro
WHERE inauguration &lt;= 2016 
ORDER BY Country</sql><sql name="SQL 3*">--CREATE VIEW PopulationS AS
SELECT Area AS Country, Year, Value * 1000 AS Population
FROM Population
WHERE Element = 'Total Population - Both sexes'
AND Year BETWEEN 1996 AND 2016
ORDER BY Country, Year</sql><sql name="SQL 4">CREATE VIEW GDPS AS
WITH corrected_Areas AS (
    SELECT CAST(CASE Area
                WHEN 'China, mainland' THEN 'China'
                WHEN 'United States of America' THEN 'USA'
                ELSE Area
            END AS TEXT
        ) AS Country,
        Year,
        ROUND(Value, 2) AS GDP
    FROM GDP
    WHERE Year BETWEEN 1996 AND 2016
    AND Element = 'Value US$ per capita'
	AND Item = 'Gross Domestic Product'
)
SELECT * FROM corrected_Areas
ORDER BY Year, Country</sql><sql name="SQL 5">CREATE VIEW CommodityS AS
WITH corrected_countries AS (
    SELECT 
        CAST(CASE country_or_area
            WHEN 'Bosnia Herzegovina' THEN 'Bosnia and Herzegovina'
            WHEN 'Central African Rep.' THEN 'Central African Republic'
            WHEN 'Cook Isds' THEN 'Cook Islands'
            WHEN 'Czech Rep.' THEN 'Czechia'
            WHEN 'Dominican Rep.' THEN 'Dominican Republic'
            WHEN 'EU-28' THEN 'European Union (27)'
            WHEN 'Fmr Fed. Rep. of Germany' THEN 'Germany'
            WHEN 'FS Micronesia' THEN 'Micronesia'
            WHEN 'Faeroe Isds' THEN 'Faroe Islands'
            WHEN 'Iran' THEN 'Iran (Islamic Republic of)'
            WHEN &quot;Lao People's Dem. Rep.&quot; THEN &quot;Lao People's Democratic Republic&quot;
            WHEN 'Neth. Antilles' THEN 'Netherlands Antilles (former)'
            WHEN 'Netherlands' THEN 'Netherlands (Kingdom of the)'
            WHEN 'Rep. of Korea' THEN 'Republic of Korea'
            WHEN 'Rep. of Moldova' THEN 'Republic of Moldova'
            WHEN 'Russia' THEN 'Russian Federation'
            WHEN 'Solomon Isds' THEN 'Solomon Islands'
            WHEN 'State of Palestine' THEN 'Palestine'
            WHEN 'Swaziland' THEN 'Eswatini'
            WHEN 'Syria' THEN 'Syrian Arab Republic'
            WHEN 'TFYR of Macedonia' THEN 'North Macedonia'
            WHEN 'Turkey' THEN 'Türkiye'
            WHEN 'Turks and Caicos Isds' THEN 'Turks and Caicos Islands'
            WHEN 'United Kingdom' THEN 'United Kingdom of Great Britain and Northern Ireland'
            WHEN 'United Rep. of Tanzania' THEN 'United Republic of Tanzania'
            WHEN 'United States' THEN 'United States of America'
            WHEN 'Venezuela' THEN 'Venezuela (Bolivarian Republic of)'
            WHEN 'Wallis and Futuna Isds' THEN 'Wallis and Futuna Islands'
            ELSE country_or_area
        END AS TEXT
        ) AS Country,
        year,
        commodity,
        flow,
        weight_kg
    FROM Commodity
    WHERE 
        year BETWEEN 1996 AND 2016
        AND commodity LIKE '%Chocolate, cocoa%'
        AND commodity NOT LIKE '%Machines%'
        AND flow IN ('Import', 'Re-Import')
)
SELECT 
    Country,
    year as Year,
    CAST(SUM(weight_kg) AS REAL) AS Total_weight_kg
FROM corrected_countries
GROUP BY country, year
ORDER BY country, year</sql><sql name="SQL 6">CREATE VIEW Commodity_M AS
SELECT 
    c.Country,
    c.Year,
    c.total_weight_kg,
    m.lines,
    m.stations,
    m.annual_ridership_mill,
    CASE 
        WHEN m.Country IS NOT NULL AND m.Year &lt;= c.Year THEN 'Yes'
        ELSE 'No'
    END AS 'availability_of_metro'
FROM 
    CommodityS c
LEFT JOIN 
    MetroS m ON c.Country = m.Country</sql><sql name="SQL 7">CREATE VIEW Commodity_M_S AS
SELECT 
    c.Country,
    c.Year,
    c.total_weight_kg,
    c.availability_of_metro,
    c.lines,
    c.stations,
    c.annual_ridership_mill,
    p.Population
FROM 
    Commodity_M c
LEFT JOIN 
    PopulationS p ON c.Country = p.Country AND c.Year = p.Year
ORDER BY 
    c.Year, 
    c.Country</sql><sql name="SQL 8">CREATE VIEW Commodity_M_S_G AS
SELECT 
    c.Country,
    c.Year,
    c.total_weight_kg,
    c.availability_of_metro,
    c.lines,
    c.stations,
    c.annual_ridership_mill,
    c.Population,
    g.GDP AS GDP_USD,
	
    CASE WHEN c.Population &gt; 0 THEN ROUND(c.total_weight_kg / c.Population, 2) ELSE NULL
    END AS kg_per_person,
	
    CASE WHEN g.GDP &gt; 0 THEN ROUND(c.total_weight_kg / g.GDP, 2) ELSE NULL
    END AS kg_per_GDP
	
FROM 
    Commodity_M_S c
LEFT JOIN 
    GDPS g ON c.Country = g.Country AND c.Year = g.Year
ORDER BY 
    c.Country,
	c.Year</sql><current_tab id="1"/></tab_sql></sqlb_project>
